{"version":3,"file":"VirtualScroller.constructor.js","names":["supportsTbody","BROWSER_NOT_SUPPORTED_ERROR","DOMEngine","Layout","LAYOUT_REASON","ScrollableContainerResizeHandler","BeforeResize","Scroll","ListHeightMeasurement","ItemHeights","log","warn","isDebug","reportError","createStateHelpers","createVerticalSpacingHelpers","createColumnsHelpers","createLayoutHelpers","createOnRenderHelpers","createScrollableContainerResizeHelpers","createItemsHelpers","VirtualScrollerConstructor","getItemsContainerElement","items","options","render","state","getInitialItemState","onStateChange","initialScrollPosition","onScrollPositionChange","scrollableContainer","measureItemsBatchSize","getColumnsCount","getItemId","tbody","estimatedItemHeight","getEstimatedVisibleItemRowsCount","onItemInitialRender","onItemFirstRender","_useTimeoutInRenderLoop","_waitForScrollingToStop","engine","bypass","getEstimatedItemHeight","getScrollableContainer","getState","setState","Error","isItemEqual","a","b","item","i","indexOf","length","call","createHelpers","waitForScrollingToStop","itemHeights","readItemHeightsFromState","beforeResize","initializeFromState","itemsContainer","createItemsContainer","clear","createScrollableContainer","container","getItemHeight","setItemHeight","height","layout","getInitialEstimatedItemHeight","getInitialEstimatedVisibleItemRowsCount","getPrerenderMargin","getVerticalSpacing","getVerticalSpacingBeforeResize","getColumnsCountBeforeResize","columnsCount","getItemHeightBeforeResize","getBeforeResizeItemsCount","getAverageItemHeight","getAverage","getMaxVisibleAreaHeight","getHeight","getPreviouslyCalculatedLayout","previouslyCalculatedLayout","scrollableContainerResizeHandler","getWidth","listenForResize","listener","onResize","onResizeStart","_isResizing","onResizeStop","undefined","onNoChange","onUpdateShownItemIndexes","reason","VIEWPORT_SIZE_UNCHANGED","onHeightChange","VIEWPORT_HEIGHT_CHANGED","onWidthChange","prevWidth","newWidth","onContainerResize","scroll","onScroll","delayed","STOPPED_SCROLLING","SCROLL","isImmediateLayoutScheduled","Boolean","layoutTimer","hasNonRenderedItemsAtTheTop","firstShownItemIndex","hasNonRenderedItemsAtTheBottom","lastShownItemIndex","getItemsCount","getLatestLayoutVisibleArea","latestLayoutVisibleArea","getListTopOffset","getListTopOffsetInsideScrollableContainer","listHeightMeasurement","watchListTopOffset","listTopOffsetWatcher","onListTopOffsetChange","TOP_OFFSET_CHANGED"],"sources":["../source/VirtualScroller.constructor.js"],"sourcesContent":["import {\n\tsupportsTbody,\n\tBROWSER_NOT_SUPPORTED_ERROR\n} from './DOM/tbody.js'\n\nimport DOMEngine from './DOM/Engine.js'\n\nimport Layout, { LAYOUT_REASON } from './Layout.js'\nimport ScrollableContainerResizeHandler from './ScrollableContainerResizeHandler.js'\nimport BeforeResize from './BeforeResize.js'\nimport Scroll from './Scroll.js'\nimport ListHeightMeasurement from './ListHeightMeasurement.js'\nimport ItemHeights from './ItemHeights.js'\n\nimport log, { warn, isDebug, reportError } from './utility/debug.js'\n\nimport createStateHelpers from './VirtualScroller.state.js'\nimport createVerticalSpacingHelpers from './VirtualScroller.verticalSpacing.js'\nimport createColumnsHelpers from './VirtualScroller.columns.js'\nimport createLayoutHelpers from './VirtualScroller.layout.js'\nimport createOnRenderHelpers from './VirtualScroller.onRender.js'\nimport createScrollableContainerResizeHelpers from './VirtualScroller.onContainerResize.js'\nimport createItemsHelpers from './VirtualScroller.items.js'\n\n/**\n * @param  {function} getItemsContainerElement — Returns the container DOM `Element`.\n * @param  {any[]} items — The list of items.\n * @param  {Object} [options] — See README.md.\n * @return {VirtualScroller}\n */\nexport default function VirtualScrollerConstructor(\n\tgetItemsContainerElement,\n\titems,\n\toptions = {}\n) {\n\tconst {\n\t\trender,\n\t\tstate,\n\t\tgetInitialItemState = () => {},\n\t\tonStateChange,\n\t\tinitialScrollPosition,\n\t\tonScrollPositionChange,\n\t\t// `scrollableContainer` option is deprecated.\n\t\t// Use `getScrollableContainer()` option instead.\n\t\tscrollableContainer,\n\t\tmeasureItemsBatchSize = 50,\n\t\tgetColumnsCount,\n\t\tgetItemId,\n\t\ttbody,\n\t\t// `estimatedItemHeight` is deprecated, use `getEstimatedItemHeight()` instead.\n\t\testimatedItemHeight,\n\t\tgetEstimatedVisibleItemRowsCount,\n\t\tonItemInitialRender,\n\t\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\t\tonItemFirstRender,\n\t\t_useTimeoutInRenderLoop,\n\t\t_waitForScrollingToStop,\n\t\tengine\n\t} = options\n\n\tlet {\n\t\tbypass,\n\t\tgetEstimatedItemHeight,\n\t\tgetScrollableContainer\n\t} = options\n\n\tlog('~ Initialize ~')\n\n\t// Could support non-DOM rendering engines.\n\t// For example, React Native, `<canvas/>`, etc.\n\tthis.engine = engine || DOMEngine\n\n\tif (!getEstimatedItemHeight && typeof estimatedItemHeight === 'number') {\n\t\tgetEstimatedItemHeight = () => estimatedItemHeight\n\t}\n\n\t// `scrollableContainer` option is deprecated.\n\t// Use `getScrollableContainer()` option instead.\n\tif (!getScrollableContainer && scrollableContainer) {\n\t\tgetScrollableContainer = () => scrollableContainer\n\t}\n\n\t// Sometimes, when `new VirtualScroller()` instance is created,\n\t// `getItemsContainerElement()` might not be ready to return the \"container\" DOM Element yet\n\t// (for example, because it's not rendered yet). That's the reason why it's a getter function.\n\t// For example, in React `<VirtualScroller/>` component, a `VirtualScroller`\n\t// instance is created in the React component's `constructor()`, and at that time\n\t// the container Element is not yet available. The container Element is available\n\t// in `componentDidMount()`, but `componentDidMount()` is not executed on server,\n\t// which would mean that React `<VirtualScroller/>` wouldn't render at all\n\t// on server side, while with the `getItemsContainerElement()` approach, on server side,\n\t// it still \"renders\" a list with a predefined amount of items in it by default.\n\t// (`initiallyRenderedItemsCount`, or `1`).\n\tthis.getItemsContainerElement = getItemsContainerElement\n\n\t// if (prerenderMargin === undefined) {\n\t// \t// Renders items which are outside of the screen by this \"prerender margin\".\n\t// \t// Is the screen height by default: seems to be the optimal value\n\t// \t// for \"Page Up\" / \"Page Down\" navigation and optimized mouse wheel scrolling.\n\t// \tprerenderMargin = this.scrollableContainer ? this.scrollableContainer.getHeight() : 0\n\t// }\n\n\tif (options.getState || options.setState) {\n\t\tthrow new Error('[virtual-scroller] `getState`/`setState` options usage has changed in the new version. See the readme for more details.')\n\t}\n\n\t// Work around `<tbody/>` not being able to have `padding`.\n\t// https://gitlab.com/catamphetamine/virtual-scroller/-/issues/1\n\tif (tbody) {\n\t\tif (this.engine !== DOMEngine) {\n\t\t\tthrow new Error('[virtual-scroller] `tbody` option is only supported for DOM rendering engine')\n\t\t}\n\t\tlog('~ <tbody/> detected ~')\n\t\tthis.tbody = true\n\t\tif (!supportsTbody()) {\n\t\t\tlog('~ <tbody/> not supported ~')\n\t\t\treportError(BROWSER_NOT_SUPPORTED_ERROR)\n\t\t\tbypass = true\n\t\t}\n\t}\n\n\tif (bypass) {\n\t\tlog('~ \"bypass\" mode ~')\n\t}\n\n\t// In `bypass` mode, `VirtualScroller` doesn't wait\n\t// for the user to scroll down to render all items:\n\t// instead, it renders all items right away, as if\n\t// the list is rendered without using `VirtualScroller`.\n\t// It was added just to measure how much is the\n\t// performance difference between using a `VirtualScroller`\n\t// and not using a `VirtualScroller`.\n\t// It turned out that unmounting large React component trees\n\t// is a very long process, so `VirtualScroller` does seem to\n\t// make sense when used in a React application.\n\tthis.bypass = bypass\n\t// this.bypassBatchSize = bypassBatchSize || 10\n\n\t// Using `setTimeout()` in render loop is a workaround\n\t// for avoiding a React error message:\n\t// \"Maximum update depth exceeded.\n\t//  This can happen when a component repeatedly calls\n\t//  `.setState()` inside `componentWillUpdate()` or `componentDidUpdate()`.\n\t//  React limits the number of nested updates to prevent infinite loops.\"\n\tthis._useTimeoutInRenderLoop = _useTimeoutInRenderLoop\n\n\tif (getItemId) {\n\t\tthis.isItemEqual = (a, b) => getItemId(a) === getItemId(b)\n\t} else {\n\t\tthis.isItemEqual = (a, b) => a === b\n\t}\n\n\tif (onItemInitialRender) {\n\t\tthis.onItemInitialRender = onItemInitialRender\n\t}\n\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\telse if (onItemFirstRender) {\n\t\tthis.onItemInitialRender = (item) => {\n\t\t\twarn('`onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.')\n\t\t\tconst { items } = this.getState()\n\t\t\tconst i = items.indexOf(item)\n\t\t\t// The `item` could also be non-found due to the inconsistency bug:\n\t\t\t// The reason is that `i` can be non-consistent with the `items`\n\t\t\t// passed to `<VirtualScroller/>` in React due to `updateState()` not being\n\t\t\t// instanteneous: when new `items` are passed to `<VirtualScroller/>`,\n\t\t\t// `VirtualScroller.updateState({ items })` is called, and if `onItemFirstRender(i)`\n\t\t\t// is called after the aforementioned `updateState()` is called but before it finishes,\n\t\t\t// `i` would point to an index in \"previous\" `items` while the application\n\t\t\t// would assume that `i` points to an index in the \"new\" `items`,\n\t\t\t// resulting in an incorrect item being assumed by the application\n\t\t\t// or even in an \"array index out of bounds\" error.\n\t\t\tif (i >= 0) {\n\t\t\t\tonItemFirstRender(i)\n\t\t\t}\n\t\t}\n\t}\n\n\t// If initial `state` is passed then use `items` from `state`\n\t// instead of the `items` argument.\n\tif (state) {\n\t\titems = state.items\n\t}\n\n\tlog('Items count', items.length)\n\tif (getEstimatedItemHeight) {\n\t\tlog('Estimated item height', getEstimatedItemHeight())\n\t}\n\n\tcreateStateHelpers.call(this, { state, getInitialItemState, onStateChange, render, items })\n\n\tcreateVerticalSpacingHelpers.call(this)\n\tcreateColumnsHelpers.call(this, { getColumnsCount })\n\n\tcreateLayoutHelpers.call(this)\n\tcreateOnRenderHelpers.call(this)\n\tcreateScrollableContainerResizeHelpers.call(this)\n\tcreateItemsHelpers.call(this)\n\n\tcreateHelpers.call(this, {\n\t\tgetScrollableContainer,\n\t\tgetEstimatedItemHeight,\n\t\tgetEstimatedVisibleItemRowsCount,\n\t\tmeasureItemsBatchSize,\n\t\tinitialScrollPosition,\n\t\tonScrollPositionChange,\n\t\twaitForScrollingToStop: _waitForScrollingToStop\n\t})\n\n\tif (state) {\n\t\t// Initialize `ItemHeights` from previously measured `state.itemHeights`.\n\t\tthis.itemHeights.readItemHeightsFromState(state)\n\n\t\t// Initialize some `BeforeResize` internal flags from a previously saved state.\n\t\tthis.beforeResize.initializeFromState(state)\n\t}\n}\n\nfunction createHelpers({\n\tgetScrollableContainer,\n\tgetEstimatedItemHeight,\n\tgetEstimatedVisibleItemRowsCount,\n\tmeasureItemsBatchSize,\n\tinitialScrollPosition,\n\tonScrollPositionChange,\n\twaitForScrollingToStop\n}) {\n\tthis.itemsContainer = this.engine.createItemsContainer(\n\t\tthis.getItemsContainerElement\n\t)\n\n\t// If the items \"container\" element is mounted at this stage,\n\t// remove any accidental text nodes from it (like whitespace).\n\t//\n\t// Also, this guards against cases when someone accidentally tries\n\t// using `VirtualScroller` on a non-empty element.\n\t//\n\tif (this.getItemsContainerElement()) {\n\t\tthis.itemsContainer.clear()\n\t}\n\n\tthis.scrollableContainer = this.engine.createScrollableContainer(\n\t\tgetScrollableContainer,\n\t\tthis.getItemsContainerElement\n\t)\n\n\t// Create `ItemHeights` instance.\n\tthis.itemHeights = new ItemHeights({\n\t\tcontainer: this.itemsContainer,\n\t\tgetItemHeight: (i) => this.getState().itemHeights[i],\n\t\tsetItemHeight: (i, height) => this.getState().itemHeights[i] = height\n\t})\n\n\tthis.layout = new Layout({\n\t\tbypass: this.bypass,\n\t\tgetInitialEstimatedItemHeight: getEstimatedItemHeight,\n\t\tgetInitialEstimatedVisibleItemRowsCount: getEstimatedVisibleItemRowsCount,\n\t\tmeasureItemsBatchSize,\n\t\tgetPrerenderMargin: () => this.getPrerenderMargin(),\n\t\tgetVerticalSpacing: () => this.getVerticalSpacing(),\n\t\tgetVerticalSpacingBeforeResize: () => this.getVerticalSpacingBeforeResize(),\n\t\tgetColumnsCount: () => this.getColumnsCount(),\n\t\tgetColumnsCountBeforeResize: () => this.getState().beforeResize && this.getState().beforeResize.columnsCount,\n\t\tgetItemHeight: (i) => this.getState().itemHeights[i],\n\t\tgetItemHeightBeforeResize: (i) => this.getState().beforeResize && this.getState().beforeResize.itemHeights[i],\n\t\tgetBeforeResizeItemsCount: () => this.getState().beforeResize ? this.getState().beforeResize.itemHeights.length : 0,\n\t\tgetAverageItemHeight: () => this.itemHeights.getAverage(),\n\t\t// `this.scrollableContainer` is gonna be `undefined` during server-side rendering.\n\t\t// https://gitlab.com/catamphetamine/virtual-scroller/-/issues/30\n\t\tgetMaxVisibleAreaHeight: () => this.scrollableContainer && this.scrollableContainer.getHeight(),\n\t\t//\n\t\t// The \"previously calculated layout\" feature is not currently used.\n\t\t//\n\t\t// The current layout snapshot could be stored as a \"previously calculated layout\" variable\n\t\t// so that it could theoretically be used when calculating new layout incrementally\n\t\t// rather than from scratch, which would be an optimization.\n\t\t//\n\t\tgetPreviouslyCalculatedLayout: () => this.previouslyCalculatedLayout\n\t})\n\n\tthis.scrollableContainerResizeHandler = new ScrollableContainerResizeHandler({\n\t\tbypass: this.bypass,\n\t\tgetWidth: () => this.scrollableContainer.getWidth(),\n\t\tgetHeight: () => this.scrollableContainer.getHeight(),\n\t\tlistenForResize: (listener) => this.scrollableContainer.onResize(listener),\n\t\tonResizeStart: () => {\n\t\t\tlog('~ Scrollable container resize started ~')\n\t\t\tthis._isResizing = true\n\t\t},\n\t\tonResizeStop: () => {\n\t\t\tlog('~ Scrollable container resize finished ~')\n\t\t\tthis._isResizing = undefined\n\t\t},\n\t\tonNoChange: () => {\n\t\t\t// There might have been some missed `this.onUpdateShownItemIndexes()` calls\n\t\t\t// due to setting `this._isResizing` flag to `true` during the resize.\n\t\t\t// So, update shown item indexes just in case.\n\t\t\tthis.onUpdateShownItemIndexes({\n\t\t\t\treason: LAYOUT_REASON.VIEWPORT_SIZE_UNCHANGED\n\t\t\t})\n\t\t},\n\t\tonHeightChange: () => this.onUpdateShownItemIndexes({\n\t\t\treason: LAYOUT_REASON.VIEWPORT_HEIGHT_CHANGED\n\t\t}),\n\t\tonWidthChange: (prevWidth, newWidth) => {\n\t\t\tlog('~ Scrollable container width changed from', prevWidth, 'to', newWidth, '~')\n\t\t\tthis.onContainerResize()\n\t\t}\n\t})\n\n\tthis.scroll = new Scroll({\n\t\tbypass: this.bypass,\n\t\tscrollableContainer: this.scrollableContainer,\n\t\titemsContainer: this.itemsContainer,\n\t\twaitForScrollingToStop,\n\t\tonScroll: ({ delayed } = {}) => {\n\t\t\tthis.onUpdateShownItemIndexes({\n\t\t\t\treason: delayed ? LAYOUT_REASON.STOPPED_SCROLLING : LAYOUT_REASON.SCROLL\n\t\t\t})\n\t\t},\n\t\tinitialScrollPosition,\n\t\tonScrollPositionChange,\n\t\tisImmediateLayoutScheduled: () => Boolean(this.layoutTimer),\n\t\thasNonRenderedItemsAtTheTop: () => this.getState().firstShownItemIndex > 0,\n\t\thasNonRenderedItemsAtTheBottom: () => this.getState().lastShownItemIndex < this.getItemsCount() - 1,\n\t\tgetLatestLayoutVisibleArea: () => this.latestLayoutVisibleArea,\n\t\tgetListTopOffset: this.getListTopOffsetInsideScrollableContainer,\n\t\tgetPrerenderMargin: () => this.getPrerenderMargin()\n\t})\n\n\tthis.listHeightMeasurement = new ListHeightMeasurement({\n\t\titemsContainer: this.itemsContainer,\n\t\tgetListTopOffset: this.getListTopOffsetInsideScrollableContainer\n\t})\n\n\tif (this.engine.watchListTopOffset) {\n\t\tthis.listTopOffsetWatcher = this.engine.watchListTopOffset({\n\t\t\tgetListTopOffset: this.getListTopOffsetInsideScrollableContainer,\n\t\t\tonListTopOffsetChange: ({ reason }) => this.onUpdateShownItemIndexes({\n\t\t\t\treason: LAYOUT_REASON.TOP_OFFSET_CHANGED\n\t\t\t})\n\t\t})\n\t}\n\n\tthis.beforeResize = new BeforeResize({\n\t\tgetState: this.getState,\n\t\tgetVerticalSpacing: this.getVerticalSpacing,\n\t\tgetColumnsCount: this.getColumnsCount\n\t})\n}"],"mappings":"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"}